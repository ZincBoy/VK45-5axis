o<_pm_renikey> sub
;CONFIGURE*MACRO

;PROBE*NO.
#<probe_number>=#1 
;RMI-Q*OPTION
#<operation>=#2
 
;#<probe_number>=1*PROBE*1 
;#<probe_number>=2*PROBE*2 
;#<probe_number>=3*PROBE*3 
;#<probe_number>=4*PROBE*4 
 
;#<operation>=1*ACQUIRE*PROBE
;#<operation>=2*CLEAR*PROBE
;#<operation>=3*CLEAR*ALL*PROBES

;motion.digital-out pin number that enables the probe, valid range depends on how many output bits are configured
#<probe_enable_pin> = #<_ini[PROBE_MACRO]PROBE_ENABLE_PIN>
;only latched mode is supported in this macro as the motion.digtial-out pin is latched
;1=PULSED*2=LATCHED
;#<pulse_mode>=2
 
;NO*EDITS*BElOW*THIS*LINE
O1 if [abs[#<probe_number>] GT 4]
    ;#<probe_number>*SET*INCORRECT
    o<_pm_renikey> return -1
O1 endif
O2 if [#<probe_number> LT 1]
    o<_pm_renikey> return -1
O2 endif
O3 if [abs[#<operation>] GT 3]
    ;#<operation>*SET*INCORRECT
    o<_pm_renikey> return -1
O3 endif
O4 if [#<operation> LT 1]
    o<_pm_renikey> return -1
O4 endif
 
;PULSE WIDTH MS
#<on_pulse>=.100
#<zero_pulse>=.300
#<one_pulse>=.550
;turn off the probe if it is on
M65 P[#<probe_enable_pin>]
G4 P2

O10 if [[#<probe_number> EQ 1] AND [#<operation> EQ 1]]
    ;ACQUIRE*PROBE1
    ;PREAMBLE
    ;ONE
    M64 P[#<probe_enable_pin>]
    G4 P[#<on_pulse>]
    M65 P[#<probe_enable_pin>]
    G4 P[#<zero_pulse>]
    M64 P[#<probe_enable_pin>]
    ;TWO
    G4 P[#<on_pulse>]
    M65 P[#<probe_enable_pin>]
    G4 P[#<zero_pulse>]
    M64 P[#<probe_enable_pin>]
    ;THREE
    G4 P[#<on_pulse>]
    M65 P[#<probe_enable_pin>]
    G4 P[#<zero_pulse>]
    M64 P[#<probe_enable_pin>]
    ;FOUR
    G4 P[#<on_pulse>]
    M65 P[#<probe_enable_pin>]
    G4 P[#<zero_pulse>]
    ;START*KEY
    M64 P[#<probe_enable_pin>] 
    G4 P[#<on_pulse>]
    M65 P[#<probe_enable_pin>]
    G4 P[#<zero_pulse>]
    M64 P[#<probe_enable_pin>] 
    G4 P[#<on_pulse>]
    M65 P[#<probe_enable_pin>]
    G4 P[#<one_pulse>]
    M64 P[#<probe_enable_pin>] 
    G4 P[#<on_pulse>]
    M65 P[#<probe_enable_pin>]
    G4 P[#<zero_pulse>]
    M64 P[#<probe_enable_pin>] 
    G4 P[#<on_pulse>]
    M65 P[#<probe_enable_pin>]
    G4 P[#<zero_pulse>]
    M64 P[#<probe_enable_pin>] 
    G4 P[#<on_pulse>]
    M65 P[#<probe_enable_pin>]
    G4 P[#<one_pulse>]
    M64 P[#<probe_enable_pin>] 
    G4 P[#<on_pulse>]
    M65 P[#<probe_enable_pin>]
    G4 P[#<zero_pulse>]
    M64 P[#<probe_enable_pin>] 
    G4 P[#<on_pulse>]
    M65 P[#<probe_enable_pin>]
    G4 P[#<one_pulse>]
    M64 P[#<probe_enable_pin>] 
    G4 P[#<on_pulse>]
    M65 P[#<probe_enable_pin>]
    G4 P[#<zero_pulse>]
    M64 P[#<probe_enable_pin>] 
    G4 P[#<on_pulse>]
    M65 P[#<probe_enable_pin>]
    G4 P[#<zero_pulse>]
    M64 P[#<probe_enable_pin>] 
    G4 P[#<on_pulse>]
    M65 P[#<probe_enable_pin>]
    G4 P[#<one_pulse>]
    M64 P[#<probe_enable_pin>] 
    G4 P[#<on_pulse>]
    M65 P[#<probe_enable_pin>]
    G4 P[#<zero_pulse>]
    M64 P[#<probe_enable_pin>] 
    G4 P[#<on_pulse>]
    M65 P[#<probe_enable_pin>]
    G4 P[#<zero_pulse>]
    M64 P[#<probe_enable_pin>] 
    G4 P[#<on_pulse>]
    M65 P[#<probe_enable_pin>]
    G4 P[#<one_pulse>]
    M64 P[#<probe_enable_pin>] 
    G4 P[#<on_pulse>]
    M65 P[#<probe_enable_pin>]
    G4 P[#<one_pulse>]
    M64 P[#<probe_enable_pin>] 
    G4 P[#<on_pulse>]
    M65 P[#<probe_enable_pin>]
    G4 P[#<one_pulse>]
    M64 P[#<probe_enable_pin>] 
    G4 P[#<on_pulse>]
    M65 P[#<probe_enable_pin>]
    G4 P[#<one_pulse>]
    M64 P[#<probe_enable_pin>] 
    G4 P[#<on_pulse>]
    M65 P[#<probe_enable_pin>]
    G4 P[#<zero_pulse>]
    M64 P[#<probe_enable_pin>] 
    G4 P[#<on_pulse>]
    M65 P[#<probe_enable_pin>]
    G4 P[#<one_pulse>]
    M64 P[#<probe_enable_pin>] 
    G4 P[#<on_pulse>]
    M65 P[#<probe_enable_pin>]
    G4 P[#<zero_pulse>]
    M64 P[#<probe_enable_pin>] 
    G4 P[#<on_pulse>]
    M65 P[#<probe_enable_pin>]
    G4 P[#<zero_pulse>]
    M64 P[#<probe_enable_pin>] 
    G4 P[#<on_pulse>]
    M65 P[#<probe_enable_pin>]
    G4 P[#<one_pulse>]
    M64 P[#<probe_enable_pin>] 
    G4 P[#<on_pulse>]
    M65 P[#<probe_enable_pin>]
    G4 P[#<zero_pulse>]
    M64 P[#<probe_enable_pin>] 
    G4 P[#<on_pulse>]
    M65 P[#<probe_enable_pin>]
    G4 P[#<zero_pulse>]
    M64 P[#<probe_enable_pin>] 
    G4 P[#<on_pulse>]
    M65 P[#<probe_enable_pin>]
    G4 P[#<zero_pulse>]
    M64 P[#<probe_enable_pin>] 
    G4 P[#<on_pulse>]
    M65 P[#<probe_enable_pin>]
    G4 P[#<zero_pulse>]
    M64 P[#<probe_enable_pin>] 
    G4 P[#<on_pulse>]
    M65 P[#<probe_enable_pin>]
    G4 P[#<one_pulse>]
    M64 P[#<probe_enable_pin>] 
    G4 P[#<on_pulse>]
    M65 P[#<probe_enable_pin>]
    G4 P[#<zero_pulse>]
    M64 P[#<probe_enable_pin>] 
    G4 P[#<on_pulse>]
    M65 P[#<probe_enable_pin>]
    G4 P[#<zero_pulse>]
    M64 P[#<probe_enable_pin>] 
    G4 P[#<on_pulse>]
    M65 P[#<probe_enable_pin>]
    G4 P[#<one_pulse>]
    M64 P[#<probe_enable_pin>] 
    G4 P[#<on_pulse>]
    M65 P[#<probe_enable_pin>]
    G4 P[#<one_pulse>]
    M64 P[#<probe_enable_pin>] 
    G4 P[#<on_pulse>]
    M65 P[#<probe_enable_pin>]
    G4 P[#<one_pulse>]
    M64 P[#<probe_enable_pin>] 
    G4 P[#<on_pulse>]
    M65 P[#<probe_enable_pin>]
    G4 P[#<zero_pulse>]
    M64 P[#<probe_enable_pin>] 
    G4 P[#<on_pulse>]
    M65 P[#<probe_enable_pin>]
    G4 P[#<zero_pulse>]
    M64 P[#<probe_enable_pin>] 
    G4 P[#<on_pulse>]
    M65 P[#<probe_enable_pin>]
    G4 P[#<zero_pulse>]
    M64 P[#<probe_enable_pin>] 
    G4 P[#<on_pulse>]
    M65 P[#<probe_enable_pin>]
    G4 P[#<zero_pulse>]
    M64 P[#<probe_enable_pin>] 
    G4 P[#<on_pulse>]
    M65 P[#<probe_enable_pin>]
    G4 P[#<zero_pulse>]
    M64 P[#<probe_enable_pin>] 
    G4 P[#<on_pulse>]
    M65 P[#<probe_enable_pin>]
    G4 P[#<zero_pulse>]
    M64 P[#<probe_enable_pin>] 
    G4 P[#<on_pulse>]
    M65 P[#<probe_enable_pin>]
    G4 P[#<zero_pulse>]
    M64 P[#<probe_enable_pin>] 
    G4 P[#<on_pulse>]
    M65 P[#<probe_enable_pin>]
    G4 P[#<zero_pulse>]
    M64 P[#<probe_enable_pin>] 
    G4 P[#<on_pulse>]
    M65 P[#<probe_enable_pin>]
    G4 P[#<zero_pulse>]
    M64 P[#<probe_enable_pin>] 
    G4 P[#<on_pulse>]
    M65 P[#<probe_enable_pin>]
    G4 P[#<zero_pulse>]
O10 else if [[#<probe_number> EQ 1] AND [#<operation> EQ 2]]
    ;UN-ACUIRE*PROBE1
    ;PREAMBLE
    M64 P[#<probe_enable_pin>]
    ;ONE
    G4 P[#<on_pulse>]
    M65 P[#<probe_enable_pin>]
    G4 P[#<zero_pulse>]
    M64 P[#<probe_enable_pin>]
    ;TWO
    G4 P[#<on_pulse>]
    M65 P[#<probe_enable_pin>]
    G4 P[#<zero_pulse>]
    M64 P[#<probe_enable_pin>]
    ;THREE
    G4 P[#<on_pulse>]
    M65 P[#<probe_enable_pin>]
    G4 P[#<zero_pulse>]
    M64 P[#<probe_enable_pin>]
    ;FOUR
    G4 P[#<on_pulse>]
    M65 P[#<probe_enable_pin>]
    G4 P[#<zero_pulse>]
    ;START*KEY
    M64 P[#<probe_enable_pin>] 
    G4 P[#<on_pulse>]
    M65 P[#<probe_enable_pin>]
    G4 P[#<zero_pulse>]
    M64 P[#<probe_enable_pin>] 
    G4 P[#<on_pulse>]
    M65 P[#<probe_enable_pin>]
    G4 P[#<one_pulse>]
    M64 P[#<probe_enable_pin>] 
    G4 P[#<on_pulse>]
    M65 P[#<probe_enable_pin>]
    G4 P[#<zero_pulse>]
    M64 P[#<probe_enable_pin>] 
    G4 P[#<on_pulse>]
    M65 P[#<probe_enable_pin>]
    G4 P[#<zero_pulse>]
    M64 P[#<probe_enable_pin>] 
    G4 P[#<on_pulse>]
    M65 P[#<probe_enable_pin>]
    G4 P[#<one_pulse>]
    M64 P[#<probe_enable_pin>] 
    G4 P[#<on_pulse>]
    M65 P[#<probe_enable_pin>]
    G4 P[#<zero_pulse>]
    M64 P[#<probe_enable_pin>] 
    G4 P[#<on_pulse>]
    M65 P[#<probe_enable_pin>]
    G4 P[#<one_pulse>]
    M64 P[#<probe_enable_pin>] 
    G4 P[#<on_pulse>]
    M65 P[#<probe_enable_pin>]
    G4 P[#<zero_pulse>]
    M64 P[#<probe_enable_pin>] 
    G4 P[#<on_pulse>]
    M65 P[#<probe_enable_pin>]
    G4 P[#<zero_pulse>]
    M64 P[#<probe_enable_pin>] 
    G4 P[#<on_pulse>]
    M65 P[#<probe_enable_pin>]
    G4 P[#<one_pulse>]
    M64 P[#<probe_enable_pin>] 
    G4 P[#<on_pulse>]
    M65 P[#<probe_enable_pin>]
    G4 P[#<zero_pulse>]
    M64 P[#<probe_enable_pin>] 
    G4 P[#<on_pulse>]
    M65 P[#<probe_enable_pin>]
    G4 P[#<zero_pulse>]
    M64 P[#<probe_enable_pin>] 
    G4 P[#<on_pulse>]
    M65 P[#<probe_enable_pin>]
    G4 P[#<one_pulse>]
    M64 P[#<probe_enable_pin>] 
    G4 P[#<on_pulse>]
    M65 P[#<probe_enable_pin>]
    G4 P[#<one_pulse>]
    M64 P[#<probe_enable_pin>] 
    G4 P[#<on_pulse>]
    M65 P[#<probe_enable_pin>]
    G4 P[#<one_pulse>]
    M64 P[#<probe_enable_pin>] 
    G4 P[#<on_pulse>]
    M65 P[#<probe_enable_pin>]
    G4 P[#<one_pulse>]
    M64 P[#<probe_enable_pin>] 
    G4 P[#<on_pulse>]
    M65 P[#<probe_enable_pin>]
    G4 P[#<zero_pulse>]
    M64 P[#<probe_enable_pin>] 
    G4 P[#<on_pulse>]
    M65 P[#<probe_enable_pin>]
    G4 P[#<one_pulse>]
    M64 P[#<probe_enable_pin>] 
    G4 P[#<on_pulse>]
    M65 P[#<probe_enable_pin>]
    G4 P[#<zero_pulse>]
    M64 P[#<probe_enable_pin>] 
    G4 P[#<on_pulse>]
    M65 P[#<probe_enable_pin>]
    G4 P[#<zero_pulse>]
    M64 P[#<probe_enable_pin>] 
    G4 P[#<on_pulse>]
    M65 P[#<probe_enable_pin>]
    G4 P[#<one_pulse>]
    M64 P[#<probe_enable_pin>] 
    G4 P[#<on_pulse>]
    M65 P[#<probe_enable_pin>]
    G4 P[#<zero_pulse>]
    M64 P[#<probe_enable_pin>] 
    G4 P[#<on_pulse>]
    M65 P[#<probe_enable_pin>]
    G4 P[#<zero_pulse>]
    M64 P[#<probe_enable_pin>] 
    G4 P[#<on_pulse>]
    M65 P[#<probe_enable_pin>]
    G4 P[#<zero_pulse>]
    M64 P[#<probe_enable_pin>] 
    G4 P[#<on_pulse>]
    M65 P[#<probe_enable_pin>]
    G4 P[#<zero_pulse>]
    M64 P[#<probe_enable_pin>] 
    G4 P[#<on_pulse>]
    M65 P[#<probe_enable_pin>]
    G4 P[#<one_pulse>]
    M64 P[#<probe_enable_pin>] 
    G4 P[#<on_pulse>]
    M65 P[#<probe_enable_pin>]
    G4 P[#<zero_pulse>]
    M64 P[#<probe_enable_pin>] 
    G4 P[#<on_pulse>]
    M65 P[#<probe_enable_pin>]
    G4 P[#<zero_pulse>]
    M64 P[#<probe_enable_pin>] 
    G4 P[#<on_pulse>]
    M65 P[#<probe_enable_pin>]
    G4 P[#<one_pulse>]
    M64 P[#<probe_enable_pin>] 
    G4 P[#<on_pulse>]
    M65 P[#<probe_enable_pin>]
    G4 P[#<one_pulse>]
    M64 P[#<probe_enable_pin>] 
    G4 P[#<on_pulse>]
    M65 P[#<probe_enable_pin>]
    G4 P[#<one_pulse>]
    M64 P[#<probe_enable_pin>] 
    G4 P[#<on_pulse>]
    M65 P[#<probe_enable_pin>]
    G4 P[#<zero_pulse>]
    M64 P[#<probe_enable_pin>] 
    G4 P[#<on_pulse>]
    M65 P[#<probe_enable_pin>]
    G4 P[#<one_pulse>]
    M64 P[#<probe_enable_pin>] 
    G4 P[#<on_pulse>]
    M65 P[#<probe_enable_pin>]
    G4 P[#<zero_pulse>]
    M64 P[#<probe_enable_pin>] 
    G4 P[#<on_pulse>]
    M65 P[#<probe_enable_pin>]
    G4 P[#<zero_pulse>]
    M64 P[#<probe_enable_pin>] 
    G4 P[#<on_pulse>]
    M65 P[#<probe_enable_pin>]
    G4 P[#<zero_pulse>]
    M64 P[#<probe_enable_pin>] 
    G4 P[#<on_pulse>]
    M65 P[#<probe_enable_pin>]
    G4 P[#<zero_pulse>]
    M64 P[#<probe_enable_pin>] 
    G4 P[#<on_pulse>]
    M65 P[#<probe_enable_pin>]
    G4 P[#<zero_pulse>]
    M64 P[#<probe_enable_pin>] 
    G4 P[#<on_pulse>]
    M65 P[#<probe_enable_pin>]
    G4 P[#<zero_pulse>]
    M64 P[#<probe_enable_pin>] 
    G4 P[#<on_pulse>]
    M65 P[#<probe_enable_pin>]
    G4 P[#<zero_pulse>]
    M64 P[#<probe_enable_pin>] 
    G4 P[#<zero_pulse>]
    M65 P[#<probe_enable_pin>]
    G4 P[#<zero_pulse>]
O10 else if [[#<probe_number> EQ 2] AND [#<operation> EQ 1]]
    ;ACQUIRE*PROBE2
    ;PREAMBLE
    M64 P[#<probe_enable_pin>]
    ;ONE
    G4 P[#<on_pulse>]
    M65 P[#<probe_enable_pin>]
    G4 P[#<zero_pulse>]
    M64 P[#<probe_enable_pin>]
    ;TWO
    G4 P[#<on_pulse>]
    M65 P[#<probe_enable_pin>]
    G4 P[#<zero_pulse>]
    M64 P[#<probe_enable_pin>]
    ;THREE
    G4 P[#<on_pulse>]
    M65 P[#<probe_enable_pin>]
    G4 P[#<zero_pulse>]
    M64 P[#<probe_enable_pin>]
    ;FOUR
    G4 P[#<on_pulse>]
    M65 P[#<probe_enable_pin>]
    G4 P[#<zero_pulse>]
    ;START*KEY
    M64 P[#<probe_enable_pin>] 
    G4 P[#<on_pulse>]
    M65 P[#<probe_enable_pin>]
    G4 P[#<zero_pulse>]
    M64 P[#<probe_enable_pin>] 
    G4 P[#<on_pulse>]
    M65 P[#<probe_enable_pin>]
    G4 P[#<one_pulse>]
    M64 P[#<probe_enable_pin>] 
    G4 P[#<on_pulse>]
    M65 P[#<probe_enable_pin>]
    G4 P[#<zero_pulse>]
    M64 P[#<probe_enable_pin>] 
    G4 P[#<on_pulse>]
    M65 P[#<probe_enable_pin>]
    G4 P[#<zero_pulse>]
    M64 P[#<probe_enable_pin>] 
    G4 P[#<on_pulse>]
    M65 P[#<probe_enable_pin>]
    G4 P[#<one_pulse>]
    M64 P[#<probe_enable_pin>] 
    G4 P[#<on_pulse>]
    M65 P[#<probe_enable_pin>]
    G4 P[#<zero_pulse>]
    M64 P[#<probe_enable_pin>] 
    G4 P[#<on_pulse>]
    M65 P[#<probe_enable_pin>]
    G4 P[#<one_pulse>]
    M64 P[#<probe_enable_pin>] 
    G4 P[#<on_pulse>]
    M65 P[#<probe_enable_pin>]
    G4 P[#<zero_pulse>]
    M64 P[#<probe_enable_pin>] 
    G4 P[#<on_pulse>]
    M65 P[#<probe_enable_pin>]
    G4 P[#<zero_pulse>]
    M64 P[#<probe_enable_pin>] 
    G4 P[#<on_pulse>]
    M65 P[#<probe_enable_pin>]
    G4 P[#<one_pulse>]
    M64 P[#<probe_enable_pin>] 
    G4 P[#<on_pulse>]
    M65 P[#<probe_enable_pin>]
    G4 P[#<zero_pulse>]
    M64 P[#<probe_enable_pin>] 
    G4 P[#<on_pulse>]
    M65 P[#<probe_enable_pin>]
    G4 P[#<zero_pulse>]
    M64 P[#<probe_enable_pin>] 
    G4 P[#<on_pulse>]
    M65 P[#<probe_enable_pin>]
    G4 P[#<one_pulse>]
    M64 P[#<probe_enable_pin>] 
    G4 P[#<on_pulse>]
    M65 P[#<probe_enable_pin>]
    G4 P[#<one_pulse>]
    M64 P[#<probe_enable_pin>] 
    G4 P[#<on_pulse>]
    M65 P[#<probe_enable_pin>]
    G4 P[#<one_pulse>]
    M64 P[#<probe_enable_pin>] 
    G4 P[#<on_pulse>]
    M65 P[#<probe_enable_pin>]
    G4 P[#<one_pulse>]
    M64 P[#<probe_enable_pin>] 
    G4 P[#<on_pulse>]
    M65 P[#<probe_enable_pin>]
    G4 P[#<zero_pulse>]
    M64 P[#<probe_enable_pin>] 
    G4 P[#<on_pulse>]
    M65 P[#<probe_enable_pin>]
    G4 P[#<one_pulse>]
    M64 P[#<probe_enable_pin>] 
    G4 P[#<on_pulse>]
    M65 P[#<probe_enable_pin>]
    G4 P[#<zero_pulse>]
    M64 P[#<probe_enable_pin>] 
    G4 P[#<on_pulse>]
    M65 P[#<probe_enable_pin>]
    G4 P[#<zero_pulse>]
    M64 P[#<probe_enable_pin>] 
    G4 P[#<on_pulse>]
    M65 P[#<probe_enable_pin>]
    G4 P[#<one_pulse>]
    M64 P[#<probe_enable_pin>] 
    G4 P[#<on_pulse>]
    M65 P[#<probe_enable_pin>]
    G4 P[#<zero_pulse>]
    M64 P[#<probe_enable_pin>] 
    G4 P[#<on_pulse>]
    M65 P[#<probe_enable_pin>]
    G4 P[#<zero_pulse>]
    M64 P[#<probe_enable_pin>] 
    G4 P[#<on_pulse>]
    M65 P[#<probe_enable_pin>]
    G4 P[#<zero_pulse>]
    M64 P[#<probe_enable_pin>] 
    G4 P[#<on_pulse>]
    M65 P[#<probe_enable_pin>]
    G4 P[#<zero_pulse>]
    M64 P[#<probe_enable_pin>] 
    G4 P[#<on_pulse>]
    M65 P[#<probe_enable_pin>]
    G4 P[#<one_pulse>]
    M64 P[#<probe_enable_pin>] 
    G4 P[#<on_pulse>]
    M65 P[#<probe_enable_pin>]
    G4 P[#<zero_pulse>]
    M64 P[#<probe_enable_pin>] 
    G4 P[#<on_pulse>]
    M65 P[#<probe_enable_pin>]
    G4 P[#<zero_pulse>]
    M64 P[#<probe_enable_pin>] 
    G4 P[#<on_pulse>]
    M65 P[#<probe_enable_pin>]
    G4 P[#<one_pulse>]
    M64 P[#<probe_enable_pin>] 
    G4 P[#<on_pulse>]
    M65 P[#<probe_enable_pin>]
    G4 P[#<one_pulse>]
    M64 P[#<probe_enable_pin>] 
    G4 P[#<on_pulse>]
    M65 P[#<probe_enable_pin>]
    G4 P[#<one_pulse>]
    M64 P[#<probe_enable_pin>] 
    G4 P[#<on_pulse>]
    M65 P[#<probe_enable_pin>]
    G4 P[#<zero_pulse>]
    M64 P[#<probe_enable_pin>] 
    G4 P[#<on_pulse>]
    M65 P[#<probe_enable_pin>]
    G4 P[#<zero_pulse>]
    M64 P[#<probe_enable_pin>] 
    G4 P[#<on_pulse>]
    M65 P[#<probe_enable_pin>]
    G4 P[#<zero_pulse>]
    M64 P[#<probe_enable_pin>] 
    G4 P[#<on_pulse>]
    M65 P[#<probe_enable_pin>]
    G4 P[#<zero_pulse>]
    M64 P[#<probe_enable_pin>] 
    G4 P[#<on_pulse>]
    M65 P[#<probe_enable_pin>]
    G4 P[#<one_pulse>]
    M64 P[#<probe_enable_pin>] 
    G4 P[#<on_pulse>]
    M65 P[#<probe_enable_pin>]
    G4 P[#<zero_pulse>]
    M64 P[#<probe_enable_pin>] 
    G4 P[#<on_pulse>]
    M65 P[#<probe_enable_pin>]
    G4 P[#<zero_pulse>]
    M64 P[#<probe_enable_pin>] 
    G4 P[#<on_pulse>]
    M65 P[#<probe_enable_pin>]
    G4 P[#<zero_pulse>]
    M64 P[#<probe_enable_pin>] 
    G4 P[#<on_pulse>]
    M65 P[#<probe_enable_pin>]
    G4 P[#<zero_pulse>]
    M64 P[#<probe_enable_pin>] 
    G4 P[#<on_pulse>]
    M65 P[#<probe_enable_pin>]
    G4 P[#<zero_pulse>]
O10 else if [[#<probe_number> EQ 2] AND [#<operation> EQ 2]]
    ;UN-ACQUIRE*PROBE2
    ;PREAMBLE
    M64 P[#<probe_enable_pin>]
    ;ONE
    G4 P[#<on_pulse>]
    M65 P[#<probe_enable_pin>]
    G4 P[#<zero_pulse>]
    M64 P[#<probe_enable_pin>]
    ;TWO
    G4 P[#<on_pulse>]
    M65 P[#<probe_enable_pin>]
    G4 P[#<zero_pulse>]
    M64 P[#<probe_enable_pin>]
    ;THREE
    G4 P[#<on_pulse>]
    M65 P[#<probe_enable_pin>]
    G4 P[#<zero_pulse>]
    M64 P[#<probe_enable_pin>]
    ;FOUR
    G4 P[#<on_pulse>]
    M65 P[#<probe_enable_pin>]
    G4 P[#<zero_pulse>]
    ;START*KEY
    M64 P[#<probe_enable_pin>] 
    G4 P[#<on_pulse>]
    M65 P[#<probe_enable_pin>]
    G4 P[#<zero_pulse>]
    M64 P[#<probe_enable_pin>] 
    G4 P[#<on_pulse>]
    M65 P[#<probe_enable_pin>]
    G4 P[#<one_pulse>]
    M64 P[#<probe_enable_pin>] 
    G4 P[#<on_pulse>]
    M65 P[#<probe_enable_pin>]
    G4 P[#<zero_pulse>]
    M64 P[#<probe_enable_pin>] 
    G4 P[#<on_pulse>]
    M65 P[#<probe_enable_pin>]
    G4 P[#<zero_pulse>]
    M64 P[#<probe_enable_pin>] 
    G4 P[#<on_pulse>]
    M65 P[#<probe_enable_pin>]
    G4 P[#<one_pulse>]
    M64 P[#<probe_enable_pin>] 
    G4 P[#<on_pulse>]
    M65 P[#<probe_enable_pin>]
    G4 P[#<zero_pulse>]
    M64 P[#<probe_enable_pin>] 
    G4 P[#<on_pulse>]
    M65 P[#<probe_enable_pin>]
    G4 P[#<one_pulse>]
    M64 P[#<probe_enable_pin>] 
    G4 P[#<on_pulse>]
    M65 P[#<probe_enable_pin>]
    G4 P[#<zero_pulse>]
    M64 P[#<probe_enable_pin>] 
    G4 P[#<on_pulse>]
    M65 P[#<probe_enable_pin>]
    G4 P[#<zero_pulse>]
    M64 P[#<probe_enable_pin>] 
    G4 P[#<on_pulse>]
    M65 P[#<probe_enable_pin>]
    G4 P[#<one_pulse>]
    M64 P[#<probe_enable_pin>] 
    G4 P[#<on_pulse>]
    M65 P[#<probe_enable_pin>]
    G4 P[#<zero_pulse>]
    M64 P[#<probe_enable_pin>] 
    G4 P[#<on_pulse>]
    M65 P[#<probe_enable_pin>]
    G4 P[#<zero_pulse>]
    M64 P[#<probe_enable_pin>] 
    G4 P[#<on_pulse>]
    M65 P[#<probe_enable_pin>]
    G4 P[#<one_pulse>]
    M64 P[#<probe_enable_pin>] 
    G4 P[#<on_pulse>]
    M65 P[#<probe_enable_pin>]
    G4 P[#<one_pulse>]
    M64 P[#<probe_enable_pin>] 
    G4 P[#<on_pulse>]
    M65 P[#<probe_enable_pin>]
    G4 P[#<one_pulse>]
    M64 P[#<probe_enable_pin>] 
    G4 P[#<on_pulse>]
    M65 P[#<probe_enable_pin>]
    G4 P[#<one_pulse>]
    M64 P[#<probe_enable_pin>] 
    G4 P[#<on_pulse>]
    M65 P[#<probe_enable_pin>]
    G4 P[#<zero_pulse>]
    M64 P[#<probe_enable_pin>] 
    G4 P[#<on_pulse>]
    M65 P[#<probe_enable_pin>]
    G4 P[#<one_pulse>]
    M64 P[#<probe_enable_pin>] 
    G4 P[#<on_pulse>]
    M65 P[#<probe_enable_pin>]
    G4 P[#<zero_pulse>]
    M64 P[#<probe_enable_pin>] 
    G4 P[#<on_pulse>]
    M65 P[#<probe_enable_pin>]
    G4 P[#<zero_pulse>]
    M64 P[#<probe_enable_pin>] 
    G4 P[#<on_pulse>]
    M65 P[#<probe_enable_pin>]
    G4 P[#<one_pulse>]
    M64 P[#<probe_enable_pin>] 
    G4 P[#<on_pulse>]
    M65 P[#<probe_enable_pin>]
    G4 P[#<zero_pulse>]
    M64 P[#<probe_enable_pin>] 
    G4 P[#<on_pulse>]
    M65 P[#<probe_enable_pin>]
    G4 P[#<zero_pulse>]
    M64 P[#<probe_enable_pin>] 
    G4 P[#<on_pulse>]
    M65 P[#<probe_enable_pin>]
    G4 P[#<zero_pulse>]
    M64 P[#<probe_enable_pin>] 
    G4 P[#<on_pulse>]
    M65 P[#<probe_enable_pin>]
    G4 P[#<zero_pulse>]
    M64 P[#<probe_enable_pin>] 
    G4 P[#<on_pulse>]
    M65 P[#<probe_enable_pin>]
    G4 P[#<one_pulse>]
    M64 P[#<probe_enable_pin>] 
    G4 P[#<on_pulse>]
    M65 P[#<probe_enable_pin>]
    G4 P[#<zero_pulse>]
    M64 P[#<probe_enable_pin>] 
    G4 P[#<on_pulse>]
    M65 P[#<probe_enable_pin>]
    G4 P[#<zero_pulse>]
    M64 P[#<probe_enable_pin>] 
    G4 P[#<on_pulse>]
    M65 P[#<probe_enable_pin>]
    G4 P[#<one_pulse>]
    M64 P[#<probe_enable_pin>] 
    G4 P[#<on_pulse>]
    M65 P[#<probe_enable_pin>]
    G4 P[#<one_pulse>]
    M64 P[#<probe_enable_pin>] 
    G4 P[#<on_pulse>]
    M65 P[#<probe_enable_pin>]
    G4 P[#<one_pulse>]
    M64 P[#<probe_enable_pin>] 
    G4 P[#<on_pulse>]
    M65 P[#<probe_enable_pin>]
    G4 P[#<zero_pulse>]
    M64 P[#<probe_enable_pin>] 
    G4 P[#<on_pulse>]
    M65 P[#<probe_enable_pin>]
    G4 P[#<one_pulse>]
    M64 P[#<probe_enable_pin>] 
    G4 P[#<on_pulse>]
    M65 P[#<probe_enable_pin>]
    G4 P[#<zero_pulse>]
    M64 P[#<probe_enable_pin>] 
    G4 P[#<on_pulse>]
    M65 P[#<probe_enable_pin>]
    G4 P[#<zero_pulse>]
    M64 P[#<probe_enable_pin>] 
    G4 P[#<on_pulse>]
    M65 P[#<probe_enable_pin>]
    G4 P[#<one_pulse>]
    M64 P[#<probe_enable_pin>] 
    G4 P[#<on_pulse>]
    M65 P[#<probe_enable_pin>]
    G4 P[#<zero_pulse>]
    M64 P[#<probe_enable_pin>] 
    G4 P[#<on_pulse>]
    M65 P[#<probe_enable_pin>]
    G4 P[#<zero_pulse>]
    M64 P[#<probe_enable_pin>] 
    G4 P[#<on_pulse>]
    M65 P[#<probe_enable_pin>]
    G4 P[#<zero_pulse>]
    M64 P[#<probe_enable_pin>] 
    G4 P[#<on_pulse>]
    M65 P[#<probe_enable_pin>]
    G4 P[#<zero_pulse>]
    M64 P[#<probe_enable_pin>]
    G4 P[#<on_pulse>]
    M65 P[#<probe_enable_pin>]
    G4 P[#<zero_pulse>]
O10 else if [[#<probe_number> EQ 3] AND [#<operation> EQ 1]]
    ;ACQUIRE*PROBE3
    ;PREAMBLE
    M64 P[#<probe_enable_pin>]
    ;ONE
    G4 P[#<on_pulse>]
    M65 P[#<probe_enable_pin>]
    G4 P[#<zero_pulse>]
    M64 P[#<probe_enable_pin>]
    ;TWO
    G4 P[#<on_pulse>]
    M65 P[#<probe_enable_pin>]
    G4 P[#<zero_pulse>]
    M64 P[#<probe_enable_pin>]
    ;THREE
    G4 P[#<on_pulse>]
    M65 P[#<probe_enable_pin>]
    G4 P[#<zero_pulse>]
    M64 P[#<probe_enable_pin>]
    ;FOUR
    G4 P[#<on_pulse>]
    M65 P[#<probe_enable_pin>]
    G4 P[#<zero_pulse>]
    ;START*KEY
    M64 P[#<probe_enable_pin>] 
    G4 P[#<on_pulse>]
    M65 P[#<probe_enable_pin>]
    G4 P[#<zero_pulse>]
    M64 P[#<probe_enable_pin>] 
    G4 P[#<on_pulse>]
    M65 P[#<probe_enable_pin>]
    G4 P[#<one_pulse>]
    M64 P[#<probe_enable_pin>] 
    G4 P[#<on_pulse>]
    M65 P[#<probe_enable_pin>]
    G4 P[#<zero_pulse>]
    M64 P[#<probe_enable_pin>] 
    G4 P[#<on_pulse>]
    M65 P[#<probe_enable_pin>]
    G4 P[#<zero_pulse>]
    M64 P[#<probe_enable_pin>] 
    G4 P[#<on_pulse>]
    M65 P[#<probe_enable_pin>]
    G4 P[#<one_pulse>]
    M64 P[#<probe_enable_pin>] 
    G4 P[#<on_pulse>]
    M65 P[#<probe_enable_pin>]
    G4 P[#<zero_pulse>]
    M64 P[#<probe_enable_pin>] 
    G4 P[#<on_pulse>]
    M65 P[#<probe_enable_pin>]
    G4 P[#<one_pulse>]
    M64 P[#<probe_enable_pin>] 
    G4 P[#<on_pulse>]
    M65 P[#<probe_enable_pin>]
    G4 P[#<zero_pulse>]
    M64 P[#<probe_enable_pin>] 
    G4 P[#<on_pulse>]
    M65 P[#<probe_enable_pin>]
    G4 P[#<zero_pulse>]
    M64 P[#<probe_enable_pin>] 
    G4 P[#<on_pulse>]
    M65 P[#<probe_enable_pin>]
    G4 P[#<one_pulse>]
    M64 P[#<probe_enable_pin>] 
    G4 P[#<on_pulse>]
    M65 P[#<probe_enable_pin>]
    G4 P[#<zero_pulse>]
    M64 P[#<probe_enable_pin>] 
    G4 P[#<on_pulse>]
    M65 P[#<probe_enable_pin>]
    G4 P[#<zero_pulse>]
    M64 P[#<probe_enable_pin>] 
    G4 P[#<on_pulse>]
    M65 P[#<probe_enable_pin>]
    G4 P[#<one_pulse>]
    M64 P[#<probe_enable_pin>] 
    G4 P[#<on_pulse>]
    M65 P[#<probe_enable_pin>]
    G4 P[#<one_pulse>]
    M64 P[#<probe_enable_pin>] 
    G4 P[#<on_pulse>]
    M65 P[#<probe_enable_pin>]
    G4 P[#<one_pulse>]
    M64 P[#<probe_enable_pin>] 
    G4 P[#<on_pulse>]
    M65 P[#<probe_enable_pin>]
    G4 P[#<one_pulse>]
    M64 P[#<probe_enable_pin>] 
    G4 P[#<on_pulse>]
    M65 P[#<probe_enable_pin>]
    G4 P[#<zero_pulse>]
    M64 P[#<probe_enable_pin>] 
    G4 P[#<on_pulse>]
    M65 P[#<probe_enable_pin>]
    G4 P[#<one_pulse>]
    M64 P[#<probe_enable_pin>] 
    G4 P[#<on_pulse>]
    M65 P[#<probe_enable_pin>]
    G4 P[#<zero_pulse>]
    M64 P[#<probe_enable_pin>] 
    G4 P[#<on_pulse>]
    M65 P[#<probe_enable_pin>]
    G4 P[#<zero_pulse>]
    M64 P[#<probe_enable_pin>] 
    G4 P[#<on_pulse>]
    M65 P[#<probe_enable_pin>]
    G4 P[#<one_pulse>]
    M64 P[#<probe_enable_pin>] 
    G4 P[#<on_pulse>]
    M65 P[#<probe_enable_pin>]
    G4 P[#<zero_pulse>]
    M64 P[#<probe_enable_pin>] 
    G4 P[#<on_pulse>]
    M65 P[#<probe_enable_pin>]
    G4 P[#<zero_pulse>]
    M64 P[#<probe_enable_pin>] 
    G4 P[#<on_pulse>]
    M65 P[#<probe_enable_pin>]
    G4 P[#<zero_pulse>]
    M64 P[#<probe_enable_pin>] 
    G4 P[#<on_pulse>]
    M65 P[#<probe_enable_pin>]
    G4 P[#<zero_pulse>]
    M64 P[#<probe_enable_pin>] 
    G4 P[#<on_pulse>]
    M65 P[#<probe_enable_pin>]
    G4 P[#<one_pulse>]
    M64 P[#<probe_enable_pin>] 
    G4 P[#<on_pulse>]
    M65 P[#<probe_enable_pin>]
    G4 P[#<zero_pulse>]
    M64 P[#<probe_enable_pin>] 
    G4 P[#<on_pulse>]
    M65 P[#<probe_enable_pin>]
    G4 P[#<zero_pulse>]
    M64 P[#<probe_enable_pin>] 
    G4 P[#<on_pulse>]
    M65 P[#<probe_enable_pin>]
    G4 P[#<one_pulse>]
    M64 P[#<probe_enable_pin>] 
    G4 P[#<on_pulse>]
    M65 P[#<probe_enable_pin>]
    G4 P[#<one_pulse>]
    M64 P[#<probe_enable_pin>] 
    G4 P[#<on_pulse>]
    M65 P[#<probe_enable_pin>]
    G4 P[#<one_pulse>]
    M64 P[#<probe_enable_pin>] 
    G4 P[#<on_pulse>]
    M65 P[#<probe_enable_pin>]
    G4 P[#<zero_pulse>] 
    M64 P[#<probe_enable_pin>] 
    G4 P[#<on_pulse>]
    M65 P[#<probe_enable_pin>]
    G4 P[#<zero_pulse>]
    M64 P[#<probe_enable_pin>] 
    G4 P[#<on_pulse>]
    M65 P[#<probe_enable_pin>]
    G4 P[#<zero_pulse>]
    M64 P[#<probe_enable_pin>] 
    G4 P[#<on_pulse>]
    M65 P[#<probe_enable_pin>]
    G4 P[#<one_pulse>]
    M64 P[#<probe_enable_pin>] 
    G4 P[#<on_pulse>]
    M65 P[#<probe_enable_pin>]
    G4 P[#<zero_pulse>]
    M64 P[#<probe_enable_pin>] 
    G4 P[#<on_pulse>]
    M65 P[#<probe_enable_pin>]
    G4 P[#<zero_pulse>]
    M64 P[#<probe_enable_pin>] 
    G4 P[#<on_pulse>]
    M65 P[#<probe_enable_pin>]
    G4 P[#<zero_pulse>]
    M64 P[#<probe_enable_pin>] 
    G4 P[#<on_pulse>]
    M65 P[#<probe_enable_pin>]
    G4 P[#<zero_pulse>]
    M64 P[#<probe_enable_pin>] 
    G4 P[#<on_pulse>]
    M65 P[#<probe_enable_pin>]
    G4 P[#<zero_pulse>]
    M64 P[#<probe_enable_pin>] 
    G4 P[#<on_pulse>]
    M65 P[#<probe_enable_pin>]
    G4 P[#<zero_pulse>]
O10 else if [[#<probe_number> EQ 3] AND [#<operation> EQ 2]]
    ;UN-ACQUIRE*PROBE3
    ;PREAMBLE
    M64 P[#<probe_enable_pin>]
    ;ONE
    G4 P[#<on_pulse>]
    M65 P[#<probe_enable_pin>]
    G4 P[#<zero_pulse>]
    M64 P[#<probe_enable_pin>]
    ;TWO
    G4 P[#<on_pulse>]
    M65 P[#<probe_enable_pin>]
    G4 P[#<zero_pulse>]
    M64 P[#<probe_enable_pin>]
    ;THREE
    G4 P[#<on_pulse>]
    M65 P[#<probe_enable_pin>]
    G4 P[#<zero_pulse>]
    M64 P[#<probe_enable_pin>]
    ;FOUR
    G4 P[#<on_pulse>]
    M65 P[#<probe_enable_pin>]
    G4 P[#<zero_pulse>]
    ;START*KEY
    M64 P[#<probe_enable_pin>] 
    G4 P[#<on_pulse>]
    M65 P[#<probe_enable_pin>]
    G4 P[#<zero_pulse>]
    M64 P[#<probe_enable_pin>] 
    G4 P[#<on_pulse>]
    M65 P[#<probe_enable_pin>]
    G4 P[#<one_pulse>]
    M64 P[#<probe_enable_pin>] 
    G4 P[#<on_pulse>]
    M65 P[#<probe_enable_pin>]
    G4 P[#<zero_pulse>]
    M64 P[#<probe_enable_pin>] 
    G4 P[#<on_pulse>]
    M65 P[#<probe_enable_pin>]
    G4 P[#<zero_pulse>]
    M64 P[#<probe_enable_pin>] 
    G4 P[#<on_pulse>]
    M65 P[#<probe_enable_pin>]
    G4 P[#<one_pulse>]
    M64 P[#<probe_enable_pin>] 
    G4 P[#<on_pulse>]
    M65 P[#<probe_enable_pin>]
    G4 P[#<zero_pulse>]
    M64 P[#<probe_enable_pin>] 
    G4 P[#<on_pulse>]
    M65 P[#<probe_enable_pin>]
    G4 P[#<one_pulse>]
    M64 P[#<probe_enable_pin>] 
    G4 P[#<on_pulse>]
    M65 P[#<probe_enable_pin>]
    G4 P[#<zero_pulse>]
    M64 P[#<probe_enable_pin>] 
    G4 P[#<on_pulse>]
    M65 P[#<probe_enable_pin>]
    G4 P[#<zero_pulse>]
    M64 P[#<probe_enable_pin>] 
    G4 P[#<on_pulse>]
    M65 P[#<probe_enable_pin>]
    G4 P[#<one_pulse>]
    M64 P[#<probe_enable_pin>] 
    G4 P[#<on_pulse>]
    M65 P[#<probe_enable_pin>]
    G4 P[#<zero_pulse>]
    M64 P[#<probe_enable_pin>] 
    G4 P[#<on_pulse>]
    M65 P[#<probe_enable_pin>]
    G4 P[#<zero_pulse>]
    M64 P[#<probe_enable_pin>] 
    G4 P[#<on_pulse>]
    M65 P[#<probe_enable_pin>]
    G4 P[#<one_pulse>]
    M64 P[#<probe_enable_pin>] 
    G4 P[#<on_pulse>]
    M65 P[#<probe_enable_pin>]
    G4 P[#<one_pulse>]
    M64 P[#<probe_enable_pin>] 
    G4 P[#<on_pulse>]
    M65 P[#<probe_enable_pin>]
    G4 P[#<one_pulse>]
    M64 P[#<probe_enable_pin>] 
    G4 P[#<on_pulse>]
    M65 P[#<probe_enable_pin>]
    G4 P[#<one_pulse>]
    M64 P[#<probe_enable_pin>] 
    G4 P[#<on_pulse>]
    M65 P[#<probe_enable_pin>]
    G4 P[#<zero_pulse>]
    M64 P[#<probe_enable_pin>] 
    G4 P[#<on_pulse>]
    M65 P[#<probe_enable_pin>]
    G4 P[#<one_pulse>]
    M64 P[#<probe_enable_pin>] 
    G4 P[#<on_pulse>]
    M65 P[#<probe_enable_pin>]
    G4 P[#<zero_pulse>]
    M64 P[#<probe_enable_pin>] 
    G4 P[#<on_pulse>]
    M65 P[#<probe_enable_pin>]
    G4 P[#<zero_pulse>]
    M64 P[#<probe_enable_pin>] 
    G4 P[#<on_pulse>]
    M65 P[#<probe_enable_pin>]
    G4 P[#<one_pulse>]
    M64 P[#<probe_enable_pin>] 
    G4 P[#<on_pulse>]
    M65 P[#<probe_enable_pin>]
    G4 P[#<zero_pulse>]
    M64 P[#<probe_enable_pin>] 
    G4 P[#<on_pulse>]
    M65 P[#<probe_enable_pin>]
    G4 P[#<zero_pulse>]
    M64 P[#<probe_enable_pin>] 
    G4 P[#<on_pulse>]
    M65 P[#<probe_enable_pin>]
    G4 P[#<zero_pulse>]
    M64 P[#<probe_enable_pin>] 
    G4 P[#<on_pulse>]
    M65 P[#<probe_enable_pin>]
    G4 P[#<zero_pulse>]
    M64 P[#<probe_enable_pin>] 
    G4 P[#<on_pulse>]
    M65 P[#<probe_enable_pin>]
    G4 P[#<one_pulse>]
    M64 P[#<probe_enable_pin>] 
    G4 P[#<on_pulse>]
    M65 P[#<probe_enable_pin>]
    G4 P[#<zero_pulse>]
    M64 P[#<probe_enable_pin>] 
    G4 P[#<on_pulse>]
    M65 P[#<probe_enable_pin>]
    G4 P[#<zero_pulse>]
    M64 P[#<probe_enable_pin>] 
    G4 P[#<on_pulse>]
    M65 P[#<probe_enable_pin>]
    G4 P[#<one_pulse>]
    M64 P[#<probe_enable_pin>] 
    G4 P[#<on_pulse>]
    M65 P[#<probe_enable_pin>]
    G4 P[#<one_pulse>]
    M64 P[#<probe_enable_pin>] 
    G4 P[#<on_pulse>]
    M65 P[#<probe_enable_pin>]
    G4 P[#<one_pulse>]
    M64 P[#<probe_enable_pin>] 
    G4 P[#<on_pulse>]
    M65 P[#<probe_enable_pin>]
    G4 P[#<zero_pulse>]
    M64 P[#<probe_enable_pin>] 
    G4 P[#<on_pulse>]
    M65 P[#<probe_enable_pin>]
    G4 P[#<one_pulse>]
    M64 P[#<probe_enable_pin>] 
    G4 P[#<on_pulse>]
    M65 P[#<probe_enable_pin>]
    G4 P[#<zero_pulse>]
    M64 P[#<probe_enable_pin>] 
    G4 P[#<on_pulse>]
    M65 P[#<probe_enable_pin>]
    G4 P[#<one_pulse>]
    M64 P[#<probe_enable_pin>] 
    G4 P[#<on_pulse>]
    M65 P[#<probe_enable_pin>]
    G4 P[#<zero_pulse>]
    M64 P[#<probe_enable_pin>] 
    G4 P[#<on_pulse>]
    M65 P[#<probe_enable_pin>]
    G4 P[#<zero_pulse>]
    M64 P[#<probe_enable_pin>] 
    G4 P[#<on_pulse>]
    M65 P[#<probe_enable_pin>]
    G4 P[#<zero_pulse>]
    M64 P[#<probe_enable_pin>] 
    G4 P[#<on_pulse>]
    M65 P[#<probe_enable_pin>]
    G4 P[#<zero_pulse>]
    M64 P[#<probe_enable_pin>] 
    G4 P[#<on_pulse>]
    M65 P[#<probe_enable_pin>]
    G4 P[#<zero_pulse>]
    M64 P[#<probe_enable_pin>] 
    G4 P[#<on_pulse>]
    M65 P[#<probe_enable_pin>]
    G4 P[#<zero_pulse>]
O10 else if [[#<probe_number> EQ 4] AND [#<operation> EQ 1]]
    ;ACQUIRE*PROBE4
    ;PREAMBLE
    M64 P[#<probe_enable_pin>]
    ;ONE
    G4 P[#<on_pulse>]
    M65 P[#<probe_enable_pin>]
    G4 P[#<zero_pulse>]
    M64 P[#<probe_enable_pin>]
    ;TWO
    G4 P[#<on_pulse>]
    M65 P[#<probe_enable_pin>]
    G4 P[#<zero_pulse>]
    M64 P[#<probe_enable_pin>]
    ;THREE
    G4 P[#<on_pulse>]
    M65 P[#<probe_enable_pin>]
    G4 P[#<zero_pulse>]
    M64 P[#<probe_enable_pin>]
    ;FOUR
    G4 P[#<on_pulse>]
    M65 P[#<probe_enable_pin>]
    G4 P[#<zero_pulse>]
    ;START*KEY
    M64 P[#<probe_enable_pin>] 
    G4 P[#<on_pulse>]
    M65 P[#<probe_enable_pin>]
    G4 P[#<zero_pulse>]
    M64 P[#<probe_enable_pin>] 
    G4 P[#<on_pulse>]
    M65 P[#<probe_enable_pin>]
    G4 P[#<one_pulse>]
    M64 P[#<probe_enable_pin>] 
    G4 P[#<on_pulse>]
    M65 P[#<probe_enable_pin>]
    G4 P[#<zero_pulse>]
    M64 P[#<probe_enable_pin>] 
    G4 P[#<on_pulse>]
    M65 P[#<probe_enable_pin>]
    G4 P[#<zero_pulse>]
    M64 P[#<probe_enable_pin>] 
    G4 P[#<on_pulse>]
    M65 P[#<probe_enable_pin>]
    G4 P[#<one_pulse>]
    M64 P[#<probe_enable_pin>] 
    G4 P[#<on_pulse>]
    M65 P[#<probe_enable_pin>]
    G4 P[#<zero_pulse>]
    M64 P[#<probe_enable_pin>] 
    G4 P[#<on_pulse>]
    M65 P[#<probe_enable_pin>]
    G4 P[#<one_pulse>]
    M64 P[#<probe_enable_pin>] 
    G4 P[#<on_pulse>]
    M65 P[#<probe_enable_pin>]
    G4 P[#<zero_pulse>]
    M64 P[#<probe_enable_pin>] 
    G4 P[#<on_pulse>]
    M65 P[#<probe_enable_pin>]
    G4 P[#<zero_pulse>]
    M64 P[#<probe_enable_pin>] 
    G4 P[#<on_pulse>]
    M65 P[#<probe_enable_pin>]
    G4 P[#<one_pulse>]
    M64 P[#<probe_enable_pin>] 
    G4 P[#<on_pulse>]
    M65 P[#<probe_enable_pin>]
    G4 P[#<zero_pulse>]
    M64 P[#<probe_enable_pin>] 
    G4 P[#<on_pulse>]
    M65 P[#<probe_enable_pin>]
    G4 P[#<zero_pulse>]
    M64 P[#<probe_enable_pin>] 
    G4 P[#<on_pulse>]
    M65 P[#<probe_enable_pin>]
    G4 P[#<one_pulse>]
    M64 P[#<probe_enable_pin>] 
    G4 P[#<on_pulse>]
    M65 P[#<probe_enable_pin>]
    G4 P[#<one_pulse>]
    M64 P[#<probe_enable_pin>] 
    G4 P[#<on_pulse>]
    M65 P[#<probe_enable_pin>]
    G4 P[#<one_pulse>]
    M64 P[#<probe_enable_pin>] 
    G4 P[#<on_pulse>]
    M65 P[#<probe_enable_pin>]
    G4 P[#<one_pulse>]
    M64 P[#<probe_enable_pin>] 
    G4 P[#<on_pulse>]
    M65 P[#<probe_enable_pin>]
    G4 P[#<zero_pulse>]
    M64 P[#<probe_enable_pin>] 
    G4 P[#<on_pulse>]
    M65 P[#<probe_enable_pin>]
    G4 P[#<one_pulse>]
    M64 P[#<probe_enable_pin>] 
    G4 P[#<on_pulse>]
    M65 P[#<probe_enable_pin>]
    G4 P[#<zero_pulse>]
    M64 P[#<probe_enable_pin>] 
    G4 P[#<on_pulse>]
    M65 P[#<probe_enable_pin>]
    G4 P[#<zero_pulse>]
    M64 P[#<probe_enable_pin>] 
    G4 P[#<on_pulse>]
    M65 P[#<probe_enable_pin>]
    G4 P[#<one_pulse>]
    M64 P[#<probe_enable_pin>] 
    G4 P[#<on_pulse>]
    M65 P[#<probe_enable_pin>]
    G4 P[#<zero_pulse>]
    M64 P[#<probe_enable_pin>] 
    G4 P[#<on_pulse>]
    M65 P[#<probe_enable_pin>]
    G4 P[#<zero_pulse>]
    M64 P[#<probe_enable_pin>] 
    G4 P[#<on_pulse>]
    M65 P[#<probe_enable_pin>]
    G4 P[#<zero_pulse>]
    M64 P[#<probe_enable_pin>] 
    G4 P[#<on_pulse>]
    M65 P[#<probe_enable_pin>]
    G4 P[#<zero_pulse>]
    M64 P[#<probe_enable_pin>] 
    G4 P[#<on_pulse>]
    M65 P[#<probe_enable_pin>]
    G4 P[#<one_pulse>]
    M64 P[#<probe_enable_pin>] 
    G4 P[#<on_pulse>]
    M65 P[#<probe_enable_pin>]
    G4 P[#<zero_pulse>]
    M64 P[#<probe_enable_pin>] 
    G4 P[#<on_pulse>]
    M65 P[#<probe_enable_pin>]
    G4 P[#<zero_pulse>]
    M64 P[#<probe_enable_pin>] 
    G4 P[#<on_pulse>]
    M65 P[#<probe_enable_pin>]
    G4 P[#<one_pulse>]
    M64 P[#<probe_enable_pin>] 
    G4 P[#<on_pulse>]
    M65 P[#<probe_enable_pin>]
    G4 P[#<one_pulse>]
    M64 P[#<probe_enable_pin>] 
    G4 P[#<on_pulse>]
    M65 P[#<probe_enable_pin>]
    G4 P[#<one_pulse>]
    M64 P[#<probe_enable_pin>] 
    G4 P[#<on_pulse>]
    M65 P[#<probe_enable_pin>]
    G4 P[#<zero_pulse>]
    M64 P[#<probe_enable_pin>] 
    G4 P[#<on_pulse>]
    M65 P[#<probe_enable_pin>]
    G4 P[#<zero_pulse>]
    M64 P[#<probe_enable_pin>] 
    G4 P[#<on_pulse>]
    M65 P[#<probe_enable_pin>]
    G4 P[#<zero_pulse>]
    M64 P[#<probe_enable_pin>] 
    G4 P[#<on_pulse>]
    M65 P[#<probe_enable_pin>]
    G4 P[#<one_pulse>]
    M64 P[#<probe_enable_pin>] 
    G4 P[#<on_pulse>]
    M65 P[#<probe_enable_pin>]
    G4 P[#<one_pulse>]
    M64 P[#<probe_enable_pin>] 
    G4 P[#<on_pulse>]
    M65 P[#<probe_enable_pin>]
    G4 P[#<zero_pulse>]
    M64 P[#<probe_enable_pin>] 
    G4 P[#<on_pulse>]
    M65 P[#<probe_enable_pin>]
    G4 P[#<zero_pulse>]
    M64 P[#<probe_enable_pin>] 
    G4 P[#<on_pulse>]
    M65 P[#<probe_enable_pin>]
    G4 P[#<zero_pulse>]
    M64 P[#<probe_enable_pin>] 
    G4 P[#<on_pulse>]
    M65 P[#<probe_enable_pin>]
    G4 P[#<zero_pulse>]
    M64 P[#<probe_enable_pin>] 
    G4 P[#<on_pulse>]
    M65 P[#<probe_enable_pin>]
    G4 P[#<zero_pulse>]
O10 else if [[#<probe_number> EQ 4] AND [#<operation> EQ 2]]
    ;UN-ACQUIRE*PROBE4
    ;PREAMBLE
    M64 P[#<probe_enable_pin>]
    ;ONE
    G4 P[#<on_pulse>]
    M65 P[#<probe_enable_pin>]
    G4 P[#<zero_pulse>]
    M64 P[#<probe_enable_pin>]
    ;TWO
    G4 P[#<on_pulse>]
    M65 P[#<probe_enable_pin>]
    G4 P[#<zero_pulse>]
    M64 P[#<probe_enable_pin>]
    ;THREE
    G4 P[#<on_pulse>]
    M65 P[#<probe_enable_pin>]
    G4 P[#<zero_pulse>]
    M64 P[#<probe_enable_pin>]
    ;FOUR   
    G4 P[#<on_pulse>]
    M65 P[#<probe_enable_pin>]
    G4 P[#<zero_pulse>]
    ;START*KEY
    M64 P[#<probe_enable_pin>] 
    G4 P[#<on_pulse>]
    M65 P[#<probe_enable_pin>]
    G4 P[#<zero_pulse>]
    M64 P[#<probe_enable_pin>] 
    G4 P[#<on_pulse>]
    M65 P[#<probe_enable_pin>]
    G4 P[#<one_pulse>]
    M64 P[#<probe_enable_pin>] 
    G4 P[#<on_pulse>]
    M65 P[#<probe_enable_pin>]
    G4 P[#<zero_pulse>]
    M64 P[#<probe_enable_pin>] 
    G4 P[#<on_pulse>]
    M65 P[#<probe_enable_pin>]
    G4 P[#<zero_pulse>]
    M64 P[#<probe_enable_pin>] 
    G4 P[#<on_pulse>]
    M65 P[#<probe_enable_pin>]
    G4 P[#<one_pulse>]
    M64 P[#<probe_enable_pin>] 
    G4 P[#<on_pulse>]
    M65 P[#<probe_enable_pin>]
    G4 P[#<zero_pulse>]
    M64 P[#<probe_enable_pin>] 
    G4 P[#<on_pulse>]
    M65 P[#<probe_enable_pin>]
    G4 P[#<one_pulse>]
    M64 P[#<probe_enable_pin>] 
    G4 P[#<on_pulse>]
    M65 P[#<probe_enable_pin>]
    G4 P[#<zero_pulse>]
    M64 P[#<probe_enable_pin>] 
    G4 P[#<on_pulse>]
    M65 P[#<probe_enable_pin>]
    G4 P[#<zero_pulse>]
    M64 P[#<probe_enable_pin>] 
    G4 P[#<on_pulse>]
    M65 P[#<probe_enable_pin>]
    G4 P[#<one_pulse>]
    M64 P[#<probe_enable_pin>] 
    G4 P[#<on_pulse>]
    M65 P[#<probe_enable_pin>]
    G4 P[#<zero_pulse>]
    M64 P[#<probe_enable_pin>] 
    G4 P[#<on_pulse>]
    M65 P[#<probe_enable_pin>]
    G4 P[#<zero_pulse>]
    M64 P[#<probe_enable_pin>] 
    G4 P[#<on_pulse>]
    M65 P[#<probe_enable_pin>]
    G4 P[#<one_pulse>]
    M64 P[#<probe_enable_pin>] 
    G4 P[#<on_pulse>]
    M65 P[#<probe_enable_pin>]
    G4 P[#<one_pulse>]
    M64 P[#<probe_enable_pin>] 
    G4 P[#<on_pulse>]
    M65 P[#<probe_enable_pin>]
    G4 P[#<one_pulse>]
    M64 P[#<probe_enable_pin>] 
    G4 P[#<on_pulse>]
    M65 P[#<probe_enable_pin>]
    G4 P[#<one_pulse>]
    M64 P[#<probe_enable_pin>] 
    G4 P[#<on_pulse>]
    M65 P[#<probe_enable_pin>]
    G4 P[#<zero_pulse>]
    M64 P[#<probe_enable_pin>] 
    G4 P[#<on_pulse>]
    M65 P[#<probe_enable_pin>]
    G4 P[#<one_pulse>]
    M64 P[#<probe_enable_pin>] 
    G4 P[#<on_pulse>]
    M65 P[#<probe_enable_pin>]
    G4 P[#<zero_pulse>]
    M64 P[#<probe_enable_pin>] 
    G4 P[#<on_pulse>]
    M65 P[#<probe_enable_pin>]
    G4 P[#<zero_pulse>]
    M64 P[#<probe_enable_pin>] 
    G4 P[#<on_pulse>]
    M65 P[#<probe_enable_pin>]
    G4 P[#<one_pulse>]
    M64 P[#<probe_enable_pin>] 
    G4 P[#<on_pulse>]
    M65 P[#<probe_enable_pin>]
    G4 P[#<zero_pulse>]
    M64 P[#<probe_enable_pin>] 
    G4 P[#<on_pulse>]
    M65 P[#<probe_enable_pin>]
    G4 P[#<zero_pulse>]
    M64 P[#<probe_enable_pin>] 
    G4 P[#<on_pulse>]
    M65 P[#<probe_enable_pin>]
    G4 P[#<zero_pulse>]
    M64 P[#<probe_enable_pin>] 
    G4 P[#<on_pulse>]
    M65 P[#<probe_enable_pin>]
    G4 P[#<zero_pulse>]
    M64 P[#<probe_enable_pin>] 
    G4 P[#<on_pulse>]
    M65 P[#<probe_enable_pin>]
    G4 P[#<one_pulse>]
    M64 P[#<probe_enable_pin>] 
    G4 P[#<on_pulse>]
    M65 P[#<probe_enable_pin>]
    G4 P[#<zero_pulse>]
    M64 P[#<probe_enable_pin>] 
    G4 P[#<on_pulse>]
    M65 P[#<probe_enable_pin>]
    G4 P[#<zero_pulse>]
    M64 P[#<probe_enable_pin>] 
    G4 P[#<on_pulse>]
    M65 P[#<probe_enable_pin>]
    G4 P[#<one_pulse>]
    M64 P[#<probe_enable_pin>] 
    G4 P[#<on_pulse>]
    M65 P[#<probe_enable_pin>]
    G4 P[#<one_pulse>]
    M64 P[#<probe_enable_pin>] 
    G4 P[#<on_pulse>]
    M65 P[#<probe_enable_pin>]
    G4 P[#<one_pulse>]
    M64 P[#<probe_enable_pin>] 
    G4 P[#<on_pulse>]
    M65 P[#<probe_enable_pin>]
    G4 P[#<zero_pulse>]
    M64 P[#<probe_enable_pin>] 
    G4 P[#<on_pulse>]
    M65 P[#<probe_enable_pin>]
    G4 P[#<one_pulse>]
    M64 P[#<probe_enable_pin>] 
    G4 P[#<on_pulse>]
    M65 P[#<probe_enable_pin>]
    G4 P[#<zero_pulse>]
    M64 P[#<probe_enable_pin>] 
    G4 P[#<on_pulse>]
    M65 P[#<probe_enable_pin>]
    G4 P[#<one_pulse>]
    M64 P[#<probe_enable_pin>] 
    G4 P[#<on_pulse>]
    M65 P[#<probe_enable_pin>]
    G4 P[#<one_pulse>]
    M64 P[#<probe_enable_pin>] 
    G4 P[#<on_pulse>]
    M65 P[#<probe_enable_pin>]
    G4 P[#<zero_pulse>]
    M64 P[#<probe_enable_pin>] 
    G4 P[#<on_pulse>]
    M65 P[#<probe_enable_pin>]
    G4 P[#<zero_pulse>]
    M64 P[#<probe_enable_pin>] 
    G4 P[#<on_pulse>]
    M65 P[#<probe_enable_pin>]
    G4 P[#<zero_pulse>]
    M64 P[#<probe_enable_pin>] 
    G4 P[#<on_pulse>]
    M65 P[#<probe_enable_pin>]
    G4 P[#<zero_pulse>]
    M64 P[#<probe_enable_pin>] 
    G4 P[#<on_pulse>]
    M65 P[#<probe_enable_pin>]
    G4 P[#<zero_pulse>]
O10 else if [#<operation> EQ 3]
    ;UN-ACQUIRE*ALL
    ;PREAMBLE
    M64 P[#<probe_enable_pin>]
    ;ONE
    G4 P[#<on_pulse>]
    M65 P[#<probe_enable_pin>]
    G4 P[#<zero_pulse>]
    M64 P[#<probe_enable_pin>]
    ;TWO
    G4 P[#<on_pulse>]
    M65 P[#<probe_enable_pin>]
    G4 P[#<zero_pulse>]
    M64 P[#<probe_enable_pin>]
    ;THREE
    G4 P[#<on_pulse>]
    M65 P[#<probe_enable_pin>]
    G4 P[#<zero_pulse>]
    M64 P[#<probe_enable_pin>]
    ;FOUR 
    G4 P[#<on_pulse>]
    M65 P[#<probe_enable_pin>]
    G4 P[#<zero_pulse>]
    ;START*KEY
    M64 P[#<probe_enable_pin>] 
    G4 P[#<on_pulse>]
    M65 P[#<probe_enable_pin>]
    G4 P[#<zero_pulse>]
    M64 P[#<probe_enable_pin>] 
    G4 P[#<on_pulse>]
    M65 P[#<probe_enable_pin>]
    G4 P[#<one_pulse>]
    M64 P[#<probe_enable_pin>] 
    G4 P[#<on_pulse>]
    M65 P[#<probe_enable_pin>]
    G4 P[#<zero_pulse>]
    M64 P[#<probe_enable_pin>] 
    G4 P[#<on_pulse>]
    M65 P[#<probe_enable_pin>]
    G4 P[#<zero_pulse>]
    M64 P[#<probe_enable_pin>] 
    G4 P[#<on_pulse>]
    M65 P[#<probe_enable_pin>]
    G4 P[#<one_pulse>]
    M64 P[#<probe_enable_pin>] 
    G4 P[#<on_pulse>]
    M65 P[#<probe_enable_pin>]
    G4 P[#<zero_pulse>]
    M64 P[#<probe_enable_pin>] 
    G4 P[#<on_pulse>]
    M65 P[#<probe_enable_pin>]
    G4 P[#<one_pulse>]
    M64 P[#<probe_enable_pin>] 
    G4 P[#<on_pulse>]
    M65 P[#<probe_enable_pin>]
    G4 P[#<zero_pulse>]
    M64 P[#<probe_enable_pin>]  
    G4 P[#<on_pulse>]
    M65 P[#<probe_enable_pin>]
    G4 P[#<zero_pulse>]
    M64 P[#<probe_enable_pin>] 
    G4 P[#<on_pulse>]
    M65 P[#<probe_enable_pin>]
    G4 P[#<one_pulse>]
    M64 P[#<probe_enable_pin>] 
    G4 P[#<on_pulse>]
    M65 P[#<probe_enable_pin>]
    G4 P[#<zero_pulse>]
    M64 P[#<probe_enable_pin>] 
    G4 P[#<on_pulse>]
    M65 P[#<probe_enable_pin>]
    G4 P[#<zero_pulse>]
    M64 P[#<probe_enable_pin>] 
    G4 P[#<on_pulse>]
    M65 P[#<probe_enable_pin>]
    G4 P[#<one_pulse>]
    M64 P[#<probe_enable_pin>] 
    G4 P[#<on_pulse>]
    M65 P[#<probe_enable_pin>]
    G4 P[#<one_pulse>]
    M64 P[#<probe_enable_pin>] 
    G4 P[#<on_pulse>]
    M65 P[#<probe_enable_pin>]
    G4 P[#<one_pulse>]
    M64 P[#<probe_enable_pin>] 
    G4 P[#<on_pulse>]
    M65 P[#<probe_enable_pin>]
    G4 P[#<one_pulse>]
    M64 P[#<probe_enable_pin>] 
    G4 P[#<on_pulse>]
    M65 P[#<probe_enable_pin>]
    G4 P[#<zero_pulse>]
    M64 P[#<probe_enable_pin>] 
    G4 P[#<on_pulse>]
    M65 P[#<probe_enable_pin>]
    G4 P[#<one_pulse>]
    M64 P[#<probe_enable_pin>] 
    G4 P[#<on_pulse>]
    M65 P[#<probe_enable_pin>]
    G4 P[#<zero_pulse>]
    M64 P[#<probe_enable_pin>] 
    G4 P[#<on_pulse>]
    M65 P[#<probe_enable_pin>]
    G4 P[#<zero_pulse>]
    M64 P[#<probe_enable_pin>] 
    G4 P[#<on_pulse>]
    M65 P[#<probe_enable_pin>]
    G4 P[#<one_pulse>]
    M64 P[#<probe_enable_pin>] 
    G4 P[#<on_pulse>]
    M65 P[#<probe_enable_pin>]
    G4 P[#<zero_pulse>]
    M64 P[#<probe_enable_pin>] 
    G4 P[#<on_pulse>]
    M65 P[#<probe_enable_pin>]
    G4 P[#<zero_pulse>]
    M64 P[#<probe_enable_pin>] 
    G4 P[#<on_pulse>]
    M65 P[#<probe_enable_pin>]
    G4 P[#<zero_pulse>]
    M64 P[#<probe_enable_pin>] 
    G4 P[#<on_pulse>]
    M65 P[#<probe_enable_pin>]
    G4 P[#<zero_pulse>]
    M64 P[#<probe_enable_pin>] 
    G4 P[#<on_pulse>]
    M65 P[#<probe_enable_pin>]
    G4 P[#<one_pulse>]
    M64 P[#<probe_enable_pin>] 
    G4 P[#<on_pulse>]
    M65 P[#<probe_enable_pin>]
    G4 P[#<zero_pulse>]
    M64 P[#<probe_enable_pin>] 
    G4 P[#<on_pulse>]
    M65 P[#<probe_enable_pin>]
    G4 P[#<zero_pulse>]
    M64 P[#<probe_enable_pin>] 
    G4 P[#<on_pulse>]
    M65 P[#<probe_enable_pin>]
    G4 P[#<one_pulse>]
    M64 P[#<probe_enable_pin>] 
    G4 P[#<on_pulse>]
    M65 P[#<probe_enable_pin>]
    G4 P[#<one_pulse>]
    M64 P[#<probe_enable_pin>] 
    G4 P[#<on_pulse>]
    M65 P[#<probe_enable_pin>]
    G4 P[#<one_pulse>]
    M64 P[#<probe_enable_pin>] 
    G4 P[#<on_pulse>]
    M65 P[#<probe_enable_pin>]
    G4 P[#<zero_pulse>]
    M64 P[#<probe_enable_pin>] 
    G4 P[#<on_pulse>]
    M65 P[#<probe_enable_pin>]
    G4 P[#<one_pulse>]
    M64 P[#<probe_enable_pin>] 
    G4 P[#<on_pulse>]
    M65 P[#<probe_enable_pin>]
    G4 P[#<one_pulse>]
    M64 P[#<probe_enable_pin>] 
    G4 P[#<on_pulse>]
    M65 P[#<probe_enable_pin>]
    G4 P[#<zero_pulse>]
    M64 P[#<probe_enable_pin>] 
    G4 P[#<on_pulse>]
    M65 P[#<probe_enable_pin>]
    G4 P[#<zero_pulse>]
    M64 P[#<probe_enable_pin>] 
    G4 P[#<on_pulse>]
    M65 P[#<probe_enable_pin>]
    G4 P[#<zero_pulse>]
    M64 P[#<probe_enable_pin>] 
    G4 P[#<on_pulse>]
    M65 P[#<probe_enable_pin>]
    G4 P[#<zero_pulse>]
    M64 P[#<probe_enable_pin>] 
    G4 P[#<on_pulse>]
    M65 P[#<probe_enable_pin>]
    G4 P[#<zero_pulse>]
    M64 P[#<probe_enable_pin>] 
    G4 P[#<on_pulse>]
    M65 P[#<probe_enable_pin>]
    G4 P[#<zero_pulse>]
    M64 P[#<probe_enable_pin>] 
    G4 P[#<on_pulse>]
    M65 P[#<probe_enable_pin>]
    G4 P[#<zero_pulse>]
O10 end if

o <_pm_renikey> endsub [0]
M2
